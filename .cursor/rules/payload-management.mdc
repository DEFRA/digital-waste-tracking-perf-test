---
description: Payload Management Rules
globs:
alwaysApply: true
---

# Payload Management Rules

## Payload Generation Structure
- Use JSR223PreProcessor with external Groovy scripts for dynamic payload generation
- Store Groovy scripts in `scripts/` directory at repository root
- Use `testType` parameter for test-specific customization
- Generate JSON payloads programmatically with variable substitution

## Payload Content Rules
- Include all required API fields
- Use JMeter variables for dynamic data: `${__threadNum}`, `${__Random()}`, etc.
- Use `${testType}` parameter for test-specific descriptions
- Include realistic but performance-focused test data
- Avoid hardcoded values that don't support load testing

## Variable Usage
- `${organisationApiId}` - Organization API ID
- `${testType}` - Test type (Baseline, Load, Stress, Spike, Basic)
- `${__time(yyyy-MM-dd'T'HH:mm:ss.SSS'Z')}` - Current timestamp
- `${__threadNum}` - Thread number for unique identification
- `${__Random(min,max)}` - Random number generation
- `${globalMovementId}` - Global movement ID (for updates)

## JMX Integration
- Use JSR223PreProcessor with external Groovy scripts for dynamic payload generation
- Use HTTP Arguments (not postBodyRaw) for complex JSON payloads with variable substitution
- Set `testType` parameter in User Defined Variables section
- Use `${payload}` variable in HTTP Arguments for clean variable substitution
- Ensure Groovy scripts are accessible from JMeter execution context

## Maintenance
- Update Groovy scripts when API changes
- Test payload changes with all test types
- Keep payload generation simple and focused on performance testing
- Avoid complex business logic in payload generation
- Use `vars.put("payload", payload)` to set the payload variable
- Ensure proper error handling in Groovy scripts